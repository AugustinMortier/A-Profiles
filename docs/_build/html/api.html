<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; A-Profiles  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> A-Profiles
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-aprofiles.reader">Reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-classes">Data Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.profiles_data">ProfilesData</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.aeronet_data">Aeronet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.rayleigh_data">Rayleigh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#detection">Detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.detection.foc">Fog or Condensation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.detection.clouds">Clouds</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.detection.pbl">Planetary Boundary Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inversion">Inversion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.inversion.aerosols">Aerosols Profiles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plotting">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.plot.image">Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.plot.profile">Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aprofiles.plot.timeseries">Time Series</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">A-Profiles</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<p>Documentation of the core API of aprofiles.</p>
<div class="section" id="module-aprofiles.reader">
<span id="reader"></span><h2>Reader<a class="headerlink" href="#module-aprofiles.reader" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="aprofiles.reader.ReadAeronet">
<em class="property">class </em><code class="sig-prename descclassname">aprofiles.reader.</code><code class="sig-name descname">ReadAeronet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/reader.html#ReadAeronet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.reader.ReadAeronet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for reading Aeronet data.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>path (str): path of the file to be read.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="aprofiles.reader.ReadProfiles">
<em class="property">class </em><code class="sig-prename descclassname">aprofiles.reader.</code><code class="sig-name descname">ReadProfiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/reader.html#ReadProfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.reader.ReadProfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for reading profiles data.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>path (str): path of the file to be read.</p>
</dd>
</dl>
<dl class="py method">
<dt id="aprofiles.reader.ReadProfiles.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/reader.html#ReadProfiles.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.reader.ReadProfiles.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Method which calls the relevant reading class based on the file name.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p><a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a></p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#import library</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Initialize reading class with file path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#calls the read method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">profiles</span><span class="p">)</span>
<span class="go">&lt;aprofiles.profilesdata.ProfilesData object at 0x7f011055fad0&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="data-classes">
<h2>Data Classes<a class="headerlink" href="#data-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-aprofiles.profiles_data">
<span id="profilesdata"></span><h3>ProfilesData<a class="headerlink" href="#module-aprofiles.profiles_data" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="aprofiles.profiles_data.ProfilesData">
<em class="property">class </em><code class="sig-prename descclassname">aprofiles.profiles_data.</code><code class="sig-name descname">ProfilesData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class representing profiles data returned by <code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.io.reader.ReadProfiles</span></code>.</p>
<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.clouds">
<code class="sig-name descname">clouds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_avg</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">thr_noise</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">thr_clouds</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.clouds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.clouds" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <a class="reference internal" href="#aprofiles.detection.clouds.detect_clouds" title="aprofiles.detection.clouds.detect_clouds"><code class="xref py py-func docutils literal notranslate"><span class="pre">aprofiles.detection.clouds.detect_clouds()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Data attribute (instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>)</p>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.desaturate_below">
<code class="sig-name descname">desaturate_below</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">4000.0</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.desaturate_below"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.desaturate_below" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove saturation caused by clouds at low altitude which results in negative values above the maximum.
The absolute value of the signal is returned below the prescribed altitude.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>var (str, optional): variable of the <code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataSet</span></code> to be processed. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>z (float, optional): Altitude (in m, AGL) below which the signal is unsaturated. Defaults to <cite>4000.</cite>.</p></li>
<li><p>inplace (bool, optional): if True, replace the <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a>. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Todo:</dt><dd><p>Refine method to desaturate only saturated areas.</p>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code></a> object with additional attribute <cite>desaturate</cite> for the processed <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.DataArray</span></code>.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For now, absolute values are returned everywhere below the prescribed altitude.</p>
</div>
<dl>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#desaturation below 4000m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">desaturate_below</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mf">4000.</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attenuated_backscatter_0</span><span class="o">.</span><span class="n">desaturated</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="figure align-default" id="id5">
<a class="reference internal image-reference" href="_images/saturated.png"><img alt="before desaturation" src="_images/saturated.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Before desaturation.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<a class="reference internal image-reference" href="_images/desaturated.png"><img alt="after desaturation" src="_images/desaturated.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">After desaturation.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.extrapolate_below">
<code class="sig-name descname">extrapolate_below</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">150</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'cst'</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.extrapolate_below"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.extrapolate_below" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for extrapolating lowest layers below a certain altitude. This is of particular intrest for instruments subject to After Pulse effect, with saturated signal in the lowest layers.
We recommend to use a value of zmin=150m due to random values often found below that altitude which perturbs the clouds detection.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>var (str, optional): variable of the <code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataSet</span></code> to be processed. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>z (float, optional): Altitude (in m, AGL) below which the signal is extrapolated. Defaults to <cite>150</cite>.</p></li>
<li><p>method ({‘cst’, ‘lin’}, optional): Method to be used for extrapolation of lowest layers. Defaults to <cite>‘cst’</cite>.</p></li>
<li><p>inplace (bool, optional): if True, replace the variable. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code></a> object with additional attributes <cite>extrapolation_low_layers_altitude_agl</cite> and <cite>extrapolation_low_layers_method</cite> for the processed <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.DataArray</span></code>.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#desaturation below 4000m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">extrapolate_below</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attenuated_backscatter_0</span><span class="o">.</span><span class="n">extrapolation_low_layers_altitude_agl</span>
<span class="go">150</span>
</pre></div>
</div>
<div class="figure align-default" id="id7">
<a class="reference internal image-reference" href="_images/lowest.png"><img alt="before extrapolation" src="_images/lowest.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Before extrapolation.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id8">
<a class="reference internal image-reference" href="_images/lowest_extrap.png"><img alt="after desaturation" src="_images/lowest_extrap.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">After extrapolation.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.foc">
<code class="sig-name descname">foc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'cloud_base'</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">z_snr</span><span class="o">=</span><span class="default_value">2000.0</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">zmin_cloud</span><span class="o">=</span><span class="default_value">200.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.foc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <a class="reference internal" href="#aprofiles.detection.foc.detect_foc" title="aprofiles.detection.foc.detect_foc"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.detection.foc.detect_foc()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.gaussian_filter">
<code class="sig-name descname">gaussian_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">0.25</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.gaussian_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a 2D gaussian filter in order to reduce high frequency noise.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>sigma (scalar or sequence of scalars, optional): Standard deviation for Gaussian kernel. The standard deviations of the Gaussian filter are given for each axis as a sequence, or as a single number, in which case it is equal for all axes. Defaults to <cite>0.25</cite>.</p></li>
<li><p>var (str, optional): variable name of the Dataset to be processed. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>inplace (bool, optional): if True, replace the variable, else use a copy. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code></a> object with additional attributes <cite>gaussian_filter</cite> for the processed <code class="xref py py-class docutils literal notranslate"><span class="pre">xr.DataArray</span></code>.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#apply gaussian filtering</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attenuated_backscatter_0</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">gaussian_filter</span>
<span class="go">0.50</span>
</pre></div>
</div>
<div class="figure align-default" id="id9">
<a class="reference internal image-reference" href="_images/attenuated_backscatter.png"><img alt="before filtering" src="_images/attenuated_backscatter.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Before gaussian filtering.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id10">
<a class="reference internal image-reference" href="_images/gaussian_filter.png"><img alt="after gaussian filtering" src="_images/gaussian_filter.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">After gaussian filtering (sigma=0.5).</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.inversion">
<code class="sig-name descname">inversion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_avg</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">4000.0</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">6000.0</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">under_clouds</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'backward'</span></em>, <em class="sig-param"><span class="n">apriori</span><span class="o">=</span><span class="default_value">{'lr': 50.0}</span></em>, <em class="sig-param"><span class="n">remove_outliers</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.inversion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <a class="reference internal" href="#aprofiles.inversion.aerosols.inversion" title="aprofiles.inversion.aerosols.inversion"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.inversion.aerosols.inversion()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.pbl">
<code class="sig-name descname">pbl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_avg</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">3000.0</span></em>, <em class="sig-param"><span class="n">wav_width</span><span class="o">=</span><span class="default_value">200.0</span></em>, <em class="sig-param"><span class="n">under_clouds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.pbl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.pbl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.detection.clouds.detect_pbl()</span></code> method.</p>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">datetime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zref</span><span class="o">=</span><span class="default_value">'agl'</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_foc</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_pbl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_clouds</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'coolwarm'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting method. 
Depending on the variable selected, this method will plot an image, a single profile or a time series of the requested variable.
See also <a class="reference internal" href="#plotting"><span class="std std-ref">Plotting</span></a>.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>var (str, optional): Variable of <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData.data" title="aprofiles.profiles_data.ProfilesData.data"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData.data</span></code></a> object to be plotted. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>datetime (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>, optional): if provided, plot the profile for closest time. If not, plot an image constructed on all profiles.Defaults to <cite>None</cite>.</p></li>
<li><p>zref (str, optional): Reference altitude. Expected values: ‘agl’ (above ground level) or ‘asl’ (above ea level). Defaults to ‘agl’</p></li>
<li><p>zmin (float, optional): Minimum altitude AGL (m). Defaults to <cite>None</cite>. If <cite>None</cite>, sets to minimum available altitude.</p></li>
<li><p>zmax (float, optional): Maximum altitude AGL (m). Defaults to <cite>None</cite>. If <cite>None</cite>, sets maximum available altitude.</p></li>
<li><p>vmin (float, optional): Minimum value. Defaults to <cite>None</cite>.</p></li>
<li><p>vmax (float, optional): Maximum value. Defaults to <cite>None</cite>. If <cite>None</cite>, calculates max from data.</p></li>
<li><p>log (bool, optional), Use logarithmic scale. Defaults to <cite>False</cite>.</p></li>
<li><p>show_foc (bool, optional): Show fog or condensation retrievals. Defaults to <cite>False</cite>.</p></li>
<li><p>show_pbl (bool, optional): Show PBL height retrievals. Defaults to <cite>False</cite>.</p></li>
<li><p>show_clouds (bool, optional): Show clouds retrievals. Defaults to <cite>False</cite>.</p></li>
<li><p>cmap (str, optional): Matplotlib colormap. Defaults to <cite>‘coolwarm’</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.range_correction">
<code class="sig-name descname">range_correction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.range_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.range_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that corrects the solid angle effect (1/z2) which makes that the backscatter beam is more unlikely to be detected with the square of the altitude.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>var (str, optional): variable of the Dataset to be processed. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>inplace (bool, optional): if True, replace the variable. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><a class="reference internal" href="#module-aprofiles.profiles_data"><span class="std std-ref">ProfilesData</span></a> object.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the range correction is not already applied to the selected variable.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.snr">
<code class="sig-name descname">snr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.snr" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that calculates the Signal to Noise Ratio.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>var (str, optional): Variable of the DataArray to calculate the SNR from. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>step (int, optional): Number of steps around we calculate the SNR for a given altitude. Defaults to <cite>4</cite>.</p></li>
<li><p>verbose (bool, optional): Verbose mode. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code></a> object with additional <code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> ‘snr’.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This calculation is relatively heavy in terms of calculation costs.</p>
</div>
<p>Example:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#snr calculcation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">snr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#snr image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;snr&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id11">
<a class="reference internal image-reference" href="_images/snr.png"><img alt="snr" src="_images/snr.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Signal to Noise Ratio.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.profiles_data.ProfilesData.time_avg">
<code class="sig-name descname">time_avg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minutes</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/profiles_data.html#ProfilesData.time_avg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.profiles_data.ProfilesData.time_avg" title="Permalink to this definition">¶</a></dt>
<dd><p>Rolling meadian on the time dimension.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>minutes (float): Number of minutes to average over.</p></li>
<li><p>var (str, optional): variable of the Dataset to be processed. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>inplace (bool, optional): if True, replace the variable, else use a copy. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><a class="reference internal" href="#module-aprofiles.profiles_data"><span class="std std-ref">ProfilesData</span></a> object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aprofiles.aeronet_data">
<span id="aeronet"></span><h3>Aeronet<a class="headerlink" href="#module-aprofiles.aeronet_data" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="aprofiles.aeronet_data.AeronetData">
<em class="property">class </em><code class="sig-prename descclassname">aprofiles.aeronet_data.</code><code class="sig-name descname">AeronetData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/aeronet_data.html#AeronetData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.aeronet_data.AeronetData" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class representing profiles data returned by <code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.io.reader.ReadAeronet</span></code>.</p>
<dl class="py method">
<dt id="aprofiles.aeronet_data.AeronetData.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#aprofiles.aeronet_data.AeronetData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Data attribute (instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aprofiles.rayleigh_data">
<span id="rayleigh"></span><h3>Rayleigh<a class="headerlink" href="#module-aprofiles.rayleigh_data" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="aprofiles.rayleigh_data.RayleighData">
<em class="property">class </em><code class="sig-prename descclassname">aprofiles.rayleigh_data.</code><code class="sig-name descname">RayleighData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">altitude</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">T0</span><span class="o">=</span><span class="default_value">298</span></em>, <em class="sig-param"><span class="n">P0</span><span class="o">=</span><span class="default_value">1013</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/rayleigh_data.html#RayleighData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.rayleigh_data.RayleighData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for computing <em>rayleigh profile</em> in a standard atmosphere.
This class calls the <code class="xref py py-func docutils literal notranslate"><span class="pre">aprofiles.rayleigh.RayleighData.get_optics_in_std_atmo()</span></code> method, which produces profiles of <cite>backscatter</cite> and <cite>extinction</cite> coefficients.</p>
<dl>
<dt>Attributes:</dt><dd><ul class="simple">
<li><p>altitude (array-like): array of altitude ASL to be used to compute the rayleigh profile, in m.</p></li>
<li><p>wavelength (float): Wavelength of the Rayleigh profile to be computed, in nm.</p></li>
<li><p>T0 (float): Temperature at ground level, in K.</p></li>
<li><p>P0 (float): Pressure at ground level, in hPa.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#some imports</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#creates altitude array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1064.</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#produce rayleigh profile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rayleigh</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">rayleigh</span><span class="o">.</span><span class="n">RayleighData</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">298</span><span class="p">,</span> <span class="n">P0</span><span class="o">=</span><span class="mi">1013</span><span class="p">);</span>
<span class="go">#checkout the class attributes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rayleigh</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">dict_keys([&#39;altitude&#39;, &#39;T0&#39;, &#39;P0&#39;, &#39;wavelength&#39;, &#39;cross_section&#39;, &#39;backscatter&#39;, &#39;extinction&#39;])</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="aprofiles.rayleigh_data.RayleighData.get_optics_in_std_atmo">
<code class="sig-name descname">get_optics_in_std_atmo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/rayleigh_data.html#RayleighData.get_optics_in_std_atmo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.rayleigh_data.RayleighData.get_optics_in_std_atmo" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns <em>backscatter</em> and <em>extinction</em> profiles for a given <a class="reference internal" href="#aprofiles.rayleigh_data.RayleighData" title="aprofiles.rayleigh_data.RayleighData"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighData</span></code></a> class.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.rayleigh.RayleighData</span></code> object with additional attributes.</dt><dd><ul class="simple">
<li><p><cite>extinction</cite> &lt;<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>&gt;: extinction coefficient (m-1)</p></li>
<li><p><cite>backscatter</cite> &lt;<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>&gt;: backscatter coefficient (m-1.sr-1)</p></li>
<li><p><cite>cross_section</cite> &lt;<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>&gt;: cross section (cm-2)</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aprofiles.rayleigh_data.RayleighData.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/rayleigh_data.html#RayleighData.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.rayleigh_data.RayleighData.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot extinction profile of the <a class="reference internal" href="#aprofiles.rayleigh_data.RayleighData" title="aprofiles.rayleigh_data.RayleighData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.rayleigh_data.RayleighData</span></code></a> instance.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#some imports</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#creates altitude array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15000</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1064.</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#produce rayleigh profile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rayleigh</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">rayleigh</span><span class="o">.</span><span class="n">RayleighData</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="mi">298</span><span class="p">,</span> <span class="n">P0</span><span class="o">=</span><span class="mi">1013</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#plot profile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rayleigh</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default" id="id12">
<a class="reference internal image-reference" href="_images/rayleigh.png"><img alt="rayleigh profile" src="_images/rayleigh.png" style="width: 480.0px; height: 480.0px;" /></a>
<p class="caption"><span class="caption-text">Rayleigh extinction profile for a standard atmosphere.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>The following functions are methods from the class <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a>.</p>
<div class="section" id="module-aprofiles.detection.foc">
<span id="fog-or-condensation"></span><h3>Fog or Condensation<a class="headerlink" href="#module-aprofiles.detection.foc" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.detection.foc.detect_foc">
<code class="sig-prename descclassname">aprofiles.detection.foc.</code><code class="sig-name descname">detect_foc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'cloud_base'</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">z_snr</span><span class="o">=</span><span class="default_value">2000.0</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">zmin_cloud</span><span class="o">=</span><span class="default_value">200.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/detection/foc.html#detect_foc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.detection.foc.detect_foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects fog or condensation.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>method ({‘cloud_base’, ‘snr’}, optional): Defaults to <cite>‘cloud_base’</cite>.</p></li>
<li><p>var (str, optional). Used for ‘snr’ method. Variable from ProfilesData to calculate SNR from. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>z_snr (float, optional): Used for ‘snr’ method. Altitude AGL (in m) at which we calculate the SNR. Defaults to <cite>2000.</cite>.</p></li>
<li><p>min_snr (float, optional): Used for ‘snr’ method. Minimum SNR under which the profile is considered as containing fog or condensation. Defaults to <cite>2.</cite>.</p></li>
<li><p>zmin_cloud (float, optional): Used for ‘cloud_base’ method. Altitude AGL (in m) below which a cloud base height is considered a fog or condensation situation. Defaults to <cite>200.</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code> object with additional Data Array.</dt><dd><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'foc'</span> <span class="pre">(time)</span></code>: mask array corresponding to the presence of foc.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#foc detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">foc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#attenuated backscatter image with pbl up to 6km of altitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_pbl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mf">6000.</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id13">
<a class="reference internal image-reference" href="_images/foc.png"><img alt="foc detection" src="_images/foc.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Fog or condensation (foc) detection.</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-aprofiles.detection.clouds">
<span id="clouds"></span><h3>Clouds<a class="headerlink" href="#module-aprofiles.detection.clouds" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.detection.clouds.detect_clouds">
<code class="sig-prename descclassname">aprofiles.detection.clouds.</code><code class="sig-name descname">detect_clouds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">time_avg</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">thr_noise</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">thr_clouds</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/detection/clouds.html#detect_clouds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.detection.clouds.detect_clouds" title="Permalink to this definition">¶</a></dt>
<dd><p>Module for <em>clouds detection</em>.
The detection is performed on each single profile individually. It is based on the analysis of the vertical gradient of the profile as respect to the level of noise measured in the profile.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>time_avg (int, optional): in minutes, the time during which we aggregates the profiles prior to the clouds detection. Defaults to <cite>1</cite>.</p></li>
<li><p>zmin (float, optional): altitude AGL, in m, above which we look for clouds. Defaults to <cite>0</cite>. We recommend using the same value as used in the extrapolation_low_layers method.</p></li>
<li><p>thr_noise (float, optional): threshold used in the test to determine if a couple (base,peak) is significant: data[peak(z)] - data[base(z)] &gt;= thr_noise * noise(z). Defaults to <cite>5</cite>.</p></li>
<li><p>thr_clouds (float, optional): threshold used to discriminate aerosol from clouds: data[peak(z)] / data[base(z)] &gt;= thr_clouds. Defaults to <cite>4</cite>.</p></li>
<li><p>min_snr (float, optional). Minimum SNR required at the clouds peak value to consider the cloud as valid. Defaults to <cite>0</cite>.</p></li>
<li><p>verbose (bool, optional): verbose mode. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code> object with additional Data Arrays.</dt><dd><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'clouds_bases'</span> <span class="pre">(time,</span> <span class="pre">altitude)</span></code>: mask array corresponding to the bases of the clouds.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'clouds_peaks'</span> <span class="pre">(time,</span> <span class="pre">altitude)</span></code>: mask array corresponding to the peaks (maximum signal measured) of the clouds.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'clouds_tops'</span> <span class="pre">(time,</span> <span class="pre">altitude)</span></code>: mask array corresponding to the top of the cloud if the beam crosses the cloud. If not, the top corresponds to the first value where the signal becomes lower than the one measured at the base of the cloud.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#clouds detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">clouds</span><span class="p">(</span><span class="n">zmin</span><span class="o">=</span><span class="mf">300.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#attenuated backscatter image with clouds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id14">
<a class="reference internal image-reference" href="_images/clouds.png"><img alt="clouds detection" src="_images/clouds.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Clouds detection.</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-aprofiles.detection.pbl">
<span id="planetary-boundary-layer"></span><h3>Planetary Boundary Layer<a class="headerlink" href="#module-aprofiles.detection.pbl" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.detection.pbl.detect_pbl">
<code class="sig-prename descclassname">aprofiles.detection.pbl.</code><code class="sig-name descname">detect_pbl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">time_avg</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">3000.0</span></em>, <em class="sig-param"><span class="n">wav_width</span><span class="o">=</span><span class="default_value">200.0</span></em>, <em class="sig-param"><span class="n">under_clouds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/detection/pbl.html#detect_pbl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.detection.pbl.detect_pbl" title="Permalink to this definition">¶</a></dt>
<dd><p>Module for <em>Planetary Boundary Layer Height</em> detection.
Detects Planetary Boundary Layer Height between zmin and zmax by looking at the maximum vertical gradient in each individual profiles.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>time_avg (int, optional): in minutes, the time during which we aggregate the profiles before detecting the PBL. Defaults to <cite>1</cite>.</p></li>
<li><p>zmin (float, optional): maximum altitude AGL, in m, for retrieving the PBL. Defaults to <cite>100</cite>.</p></li>
<li><p>zmin (float, optional): minimum altitude AGL, in m, for retrieving the PBL. Defaults to <cite>3000</cite>.</p></li>
<li><p>wav_width (float, optional): Width of the wavelet used in the convolution, in m. Defaults to <cite>200</cite>.</p></li>
<li><p>under_clouds (bool, optional): If True, and if clouds detection have been called before, force the PBL to be found below the first cloud detected in the profile. Defaults to <cite>True</cite>.</p></li>
<li><p>min_snr (float, optional). Minimum SNR at the retrieved PBL height required to return a valid value. Defaults to <cite>2.</cite>.</p></li>
<li><p>verbose (bool, optional): verbose mode. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code> object with additional Data Array.</dt><dd><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'pbl'</span> <span class="pre">(time,</span> <span class="pre">altitude)</span></code>: mask array corresponding to the pbl height.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pbl detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">pbl</span><span class="p">(</span><span class="n">zmin</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mf">3000.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#attenuated backscatter image with pbl up to 6km of altitude</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_pbl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mf">6000.</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id15">
<a class="reference internal image-reference" href="_images/pbl.png"><img alt="clouds detection" src="_images/pbl.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">PLanetary Boundary Layer Height detection.</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="inversion">
<h2>Inversion<a class="headerlink" href="#inversion" title="Permalink to this headline">¶</a></h2>
<p>The following functions are methods from the class <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a>.</p>
<div class="section" id="module-aprofiles.inversion.aerosols">
<span id="aerosols-profiles"></span><h3>Aerosols Profiles<a class="headerlink" href="#module-aprofiles.inversion.aerosols" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.inversion.aerosols.backward_inversion">
<code class="sig-prename descclassname">aprofiles.inversion.aerosols.</code><code class="sig-name descname">backward_inversion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">iref</span></em>, <em class="sig-param"><span class="n">apriori</span></em>, <em class="sig-param"><span class="n">rayleigh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/inversion/aerosols.html#backward_inversion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.inversion.aerosols.backward_inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Backward (Klett <a class="footnote-reference brackets" href="#id2" id="id1">1</a> ) inversion method.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Klett, J. D. (1985). Lidar inversion with variable backscatter/extinction ratios. Applied optics, 24(11), 1638-1643.</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>data (array_like): 1D Array of single profile of attenuated backscatter coefficient.</p></li>
<li><p>iref (float): index of the reference altitude returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">aprofiles.inversion.ref_altitude.get_iref()</span></code>.</p></li>
<li><p>apriori (dict): A priori value to be used to constrain the inversion. Valid keys: ‘lr’ (Lidar Ratio, in sr) and ‘aod’ (unitless).</p></li>
<li><p>rayleigh (:class: <cite>aprofiles.rayleigh.RayleighData</cite>): aprofiles RayleighData object.</p></li>
</ul>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: AOD apriori is not implemented yet.</p>
</dd>
<dt>Returns:</dt><dd><p>array_like: Extinction coefficient, in m-1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="aprofiles.inversion.aerosols.forward_inversion">
<code class="sig-prename descclassname">aprofiles.inversion.aerosols.</code><code class="sig-name descname">forward_inversion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">iref</span></em>, <em class="sig-param"><span class="n">apriori</span></em>, <em class="sig-param"><span class="n">rayleigh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/inversion/aerosols.html#forward_inversion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.inversion.aerosols.forward_inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward iterative inversion method <a class="footnote-reference brackets" href="#id4" id="id3">2</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Li, D., Wu, Y., Gross, B., &amp; Moshary, F. (2021). Capabilities of an Automatic Lidar Ceilometer to Retrieve Aerosol Characteristics within the Planetary Boundary Layer. Remote Sensing, 13(18), 3626.</p>
</dd>
</dl>
<p>Method principle:</p>
<p>At z0, the aerosol transmission is first assumed a being close to 1. We evaluate the aerosol extinction based on this assumption. 
This evaluation gives a refined aerosol extinction that is used to calculate a second time the aerosol transmission.
The aerosol extinction retrieval will converge after a certain number iterations.
After the convergence, the aerosol extinction is retrieved in the next upper layer.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>data (array_like): 1D Array of single profile of attenuated backscatter coefficient.</p></li>
<li><p>iref (float): index of the reference altitude returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">aprofiles.inversion.ref_altitude.get_iref()</span></code>.</p></li>
<li><p>apriori (dict): A priori value to be used to constrain the inversion. Valid keys: ‘lr’ (Lidar Ratio, in sr) and ‘aod’ (unitless).</p></li>
<li><p>rayleigh (:class: <cite>aprofiles.rayleigh.RayleighData</cite>): aprofiles RayleighData object.</p></li>
</ul>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: AOD apriori is not implemented yet.</p>
</dd>
<dt>Returns:</dt><dd><p>array_like: Extinction coefficient, in m-1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="aprofiles.inversion.aerosols.inversion">
<code class="sig-prename descclassname">aprofiles.inversion.aerosols.</code><code class="sig-name descname">inversion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">time_avg</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">4000.0</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">6000.0</span></em>, <em class="sig-param"><span class="n">min_snr</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">under_clouds</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'forward'</span></em>, <em class="sig-param"><span class="n">apriori</span><span class="o">=</span><span class="default_value">{'lr': 50.0}</span></em>, <em class="sig-param"><span class="n">remove_outliers</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/inversion/aerosols.html#inversion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.inversion.aerosols.inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Aerosol inversion of the attenuated backscatter profiles using an apriori.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>time_avg (int, optional): in minutes, the time during which we aggregate the profiles before inverting the profiles. Defaults to 1.</p></li>
<li><p>zmin (float, optional): minimum altitude AGL, in m, for looking for the initialization altitude. Defaults to 4000..</p></li>
<li><p>zmax (float, optional): maximum altitude AGL, in m, for looking for the initialization altitude. Defaults to 6000..</p></li>
<li><p>min_snr (float, optional). Minimum SNR required at the reference altitude to be valid. Defaults to 0.</p></li>
<li><p>under_clouds (bool, optional): If True, and if the <cite>ProfilesData</cite> has a <cite>cloud_base</cite> variable (returned by the <cite>clouds</cite> method), forces the initialization altitude to be found below the first cloud detected in the profile. Defaults to True.</p></li>
<li><p>method ({‘backward’, ‘forward’}, optional). Defaults to ‘forward’.</p></li>
<li><p>apriori (dict, optional). A priori value to be used to constrain the inversion. Valid keys: ‘lr’ (Lidar Ratio, in sr) and ‘aod’ (unitless). Defaults to {‘lr’: 50}.</p></li>
<li><p>remove_outliers (bool, optional). Remove profiles considered as outliers based on aod calculation ([&gt;0, &lt;1]). Defaults to False (while development. to be changed afterwards).</p></li>
<li><p>verbose (bool, optional): verbose mode. Defaults to False.</p></li>
</ul>
</dd>
<dt>Raises:</dt><dd><p>NotImplementedError: AOD apriori is not implemented yet.</p>
</dd>
<dt>Returns:</dt><dd><dl>
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesData</span></code> object with additional Data Array.</dt><dd><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'extinction'</span> <span class="pre">(time,</span> <span class="pre">altitude)</span></code>: 2D array corresponding to the aerosol extinction.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'aod'</span> <span class="pre">(time)</span></code>: 1D array corresponding to the aerosol optical depth associated to the extinction profiles.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span> <span class="pre">'lidar_ratio'</span> <span class="pre">(time)</span></code>: 1D array corresponding to the lidar ratio associated to the extinction profiles.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><p>Profiles preparation</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#extrapolate lowest layers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">extrapolate_below</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Backward inversion</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#aerosol inversion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">inversion</span><span class="p">(</span><span class="n">zmin</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;backward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#plot extinction profiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;extinction&#39;</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id16">
<a class="reference internal image-reference" href="_images/backward.png"><img alt="clouds detection" src="_images/backward.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Extinction profiles retrieved with the backward method.</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p>Forward inversion</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#aerosol inversion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">inversion</span><span class="p">(</span><span class="n">zmin</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;backward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#plot extinction profiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;extinction&#39;</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id17">
<a class="reference internal image-reference" href="_images/forward.png"><img alt="clouds detection" src="_images/forward.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Extinction profiles retrieved with the forward method.</span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-aprofiles.plot.image">
<span id="image"></span><h3>Image<a class="headerlink" href="#module-aprofiles.plot.image" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.plot.image.plot">
<code class="sig-prename descclassname">aprofiles.plot.image.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">da</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">zref</span><span class="o">=</span><span class="default_value">'agl'</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_foc</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_pbl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_clouds</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'coolwarm'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/plot/image.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.plot.image.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot image of selected variable from <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a> object.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>da (<code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>): DataArray.</p></li>
<li><p>var (str, optional): Variable of the DataArray to be plotted. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>zref ({‘agl’, ‘asl’},optional): Base reference for altitude axis. Defaults to ‘agl’.</p></li>
<li><p>zmin (float, optional): Minimum altitude AGL (m). Defaults to minimum available altitude.</p></li>
<li><p>zmax (float, optional): Maximum altitude AGL (m). Defaults to maximum available altitude.</p></li>
<li><p>vmin (float, optional): Minimum value. Defaults to <cite>None</cite>.</p></li>
<li><p>vmax (float, optional): Maximum value. If None, calculates max from data.</p></li>
<li><p>log (bool, optional), Use logarithmic scale. Defaults to <cite>None</cite>.</p></li>
<li><p>show_foc (bool, optional): Add foc detection. Defaults to <cite>False</cite>.</p></li>
<li><p>show_pbl (bool, optional): Add PBL height. Defaults to <cite>False</cite>.</p></li>
<li><p>show_clouds (bool, optional): Add clouds detection. Defaults to <cite>False</cite>.</p></li>
<li><p>cmap (str, optional): Matplotlib colormap. Defaults to <cite>‘coolwarm’</cite> cmap from seaborn.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#attenuated backscatter image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id18">
<a class="reference internal image-reference" href="_images/attenuated_backscatter.png"><img alt="attenuated backscatter profiles" src="_images/attenuated_backscatter.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Image of attenuated backscatter profiles.</span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-aprofiles.plot.profile">
<span id="profile"></span><h3>Profile<a class="headerlink" href="#module-aprofiles.plot.profile" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.plot.profile.plot">
<code class="sig-prename descclassname">aprofiles.plot.profile.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">da</span></em>, <em class="sig-param"><span class="n">datetime</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'attenuated_backscatter_0'</span></em>, <em class="sig-param"><span class="n">zref</span><span class="o">=</span><span class="default_value">'agl'</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_foc</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_pbl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_clouds</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/plot/profile.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.plot.profile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot single profile of selected variable from <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a> object.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>da (<code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>): DataArray.</p></li>
<li><p>datetime (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>): time for which we plot the profile.</p></li>
<li><p>var (str, optional): Variable of the DataArray to be plotted. Defaults to <cite>‘attenuated_backscatter_0’</cite>.</p></li>
<li><p>zref ({‘agl’, ‘asl’},optional): Base reference for altitude axis. Defaults to ‘agl’.</p></li>
<li><p>zmin (float, optional): Minimum altitude AGL (m). Defaults to minimum available altitude.</p></li>
<li><p>zmax (float, optional): Maximum altitude AGL (m). Defaults to maximum available altitude.</p></li>
<li><p>vmin (float, optional): Minimum value. Defaults to <cite>0</cite>.</p></li>
<li><p>vmax (float, optional): Maximum value. If None, calculates max from data.</p></li>
<li><p>log (bool, optional), Use logarithmic scale. Defaults to <cite>None</cite>.</p></li>
<li><p>show_foc (bool, optional): Add foc detection. Defaults to <cite>False</cite>.</p></li>
<li><p>show_pbl (bool, optional): Add PBL height. Defaults to <cite>False</cite>.</p></li>
<li><p>show_clouds (bool, optional): Add clouds detection. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#some detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">clouds</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">pbl</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#attenuated backscatter single profile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datetime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2021-09-09T10:25:00&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="n">datetime</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">12000</span><span class="p">,</span> <span class="n">show_clouds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_pbl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id19">
<a class="reference internal image-reference" href="_images/profile.png"><img alt="profile" src="_images/profile.png" style="width: 480.0px; height: 480.0px;" /></a>
<p class="caption"><span class="caption-text">Single profile of attenuated backscatter.</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-aprofiles.plot.timeseries">
<span id="time-series"></span><h3>Time Series<a class="headerlink" href="#module-aprofiles.plot.timeseries" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="aprofiles.plot.timeseries.plot">
<code class="sig-prename descclassname">aprofiles.plot.timeseries.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">da</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">'aod'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aprofiles/plot/timeseries.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aprofiles.plot.timeseries.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot time series of selected variable from <a class="reference internal" href="#aprofiles.profiles_data.ProfilesData" title="aprofiles.profiles_data.ProfilesData"><code class="xref py py-class docutils literal notranslate"><span class="pre">aprofiles.profiles_data.ProfilesData</span></code></a> object.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>da (<code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>): DataArray</p></li>
<li><p>var (str, optional): [description]. Defaults to <cite>‘aod’</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aprofiles</span> <span class="k">as</span> <span class="nn">apro</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#read example file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;examples/data/L2_0-20000-001492_A20210909.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">apro</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">ReadProfiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#retrieve pbl height</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">pbl</span><span class="p">(</span><span class="n">zmin</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#attenuated backscatter image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s2">&quot;pbl&quot;</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">3000.</span><span class="p">,</span> <span class="n">min_snr</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id20">
<a class="reference internal image-reference" href="_images/time_series.png"><img alt="time series" src="_images/time_series.png" style="width: 600.0px; height: 200.0px;" /></a>
<p class="caption"><span class="caption-text">Time series of Planetary Boundary Layer height.</span><a class="headerlink" href="#id20" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Augustin Mortier.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>